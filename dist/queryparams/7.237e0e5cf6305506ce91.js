(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{Yj9t:function(e,t,s){"use strict";s.r(t),s.d(t,"AuthModule",(function(){return b}));var r=s("ofXK"),o=s("tyNb"),i=s("tk/3"),a=s("AytR"),n=s("fXoL"),c=s("6uu6"),l=s("LWby");let h=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Gb({type:e,selectors:[["app-header"]],decls:3,vars:0,consts:[[1,"header","d-flex","justify-content-between","shadow-lg"],[1,"header-logo"],["src","assets/icon.JPG","alt","","srcset","",1,"header-image"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"span",1),n.Nb(2,"img",2),n.Rb(),n.Rb())},styles:[".header[_ngcontent-%COMP%]{padding:.2rem 2rem;background-color:#e53600;display:flex;justify-content:center;align-items:center}.header-logo[_ngcontent-%COMP%]{padding:.6rem;background-color:#fff;border-radius:50px}.header-image[_ngcontent-%COMP%]{height:48px;width:48px}"]}),e})();var d=s("Xa2L");function g(e,t){if(1&e){const e=n.Tb();n.Sb(0,"img",6),n.Zb("click",(function(){return n.kc(e),n.dc().drivePermission()})),n.Rb()}}function u(e,t){1&e&&n.Nb(0,"mat-progress-spinner",7),2&e&&n.gc("diameter",32)("strokeWidth",8)}const m=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:(()=>{class e{constructor(e,t,s,r,o){this.authService=e,this.router=t,this.route=s,this.http=r,this.configService=o,this.userEmail=localStorage.getItem("userEmail"),this.headerColumns=["numar lucare","depus ocpi","benificiar","proprietar","observatii","Uat","adresa","cf","identificator","contract servici","pret total lucare","avans","differenta","ocpi","bcpi","anul","numar cerere ocpi","data inregistere","terman","tipul","stare curenta","lucrare"]}ngOnInit(){this.configService.sharedConfig.subscribe(e=>this.config=e),this.route.queryParams.subscribe(e=>{this.driveToken=e.code}),this.driveToken&&(this.configService.setConfig({isLoader:!0}),this.getDriveToken())}drivePermission(){this.configService.setConfig({isLoader:!0}),this.authService.askDrivePermission()}getSheetId(){this.http.get(a.a.baseUrl+"fetch/sheetId/"+this.userEmail).subscribe(e=>{localStorage.setItem("refreshToken",e.data.refreshToken),localStorage.setItem("userEmail",e.data.email),localStorage.setItem("sheetId",e.data.sheetId),this.gotoHome()},e=>{console.error(e),404===e.status&&this.createSheet()})}getDriveToken(){this.http.post(a.a.baseUrl+"token",{code:this.driveToken}).subscribe(e=>{localStorage.setItem("driveAccessToken",e.data.access_token),localStorage.setItem("userEmail",e.data.email),localStorage.setItem("userName",e.data.name),localStorage.setItem("refreshToken",e.data.refresh_token),this.driveAccessToken=e.data.access_token,this.userEmail=e.data.email,this.getSheetId()},e=>{console.error(e)})}createSheet(){var e={headers:(new i.c).set("Authorization","Bearer "+this.driveAccessToken)};this.http.post(a.a.baseUrl+"sheets",{name:"test"},e).subscribe(e=>{const t={email:this.userEmail,sheetId:e.data.spreadsheetId,refreshToken:localStorage.getItem("refreshToken")};this.http.post(a.a.baseUrl+"post/sheetId",t).subscribe(t=>{localStorage.setItem("sheetId",e.data.spreadsheetId),this.gotoHome()},e=>{console.error(e)})},e=>{console.error(e)})}createHeader(){const e={sheetId:localStorage.getItem("sheetId"),workSheetName:"Sheet1",values:[this.headerColumns]};var t={headers:(new i.c).set("Authorization","Bearer "+this.driveAccessToken)};this.http.post(a.a.baseUrl+"work/sheets/rows",e,t).subscribe(e=>{this.gotoHome()},e=>{console.error(e)})}gotoHome(){this.router.navigate(["/dashboard"])}googleAuth(){this.configService.setConfig({isLoader:!0}),this.authService.GoogleAuth()}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(c.a),n.Mb(o.b),n.Mb(o.a),n.Mb(i.a),n.Mb(l.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-login"]],decls:9,vars:2,consts:[[1,"full-screen-page"],[1,"card","shadow-lg","d-flex","flex-column","justify-content-center","align-items-center","p-5","rounded"],[1,"login-text-welcome"],[1,"login-text","mb-2"],["class","cursor-pointer","src","assets/btn_google.png","alt","login-btn",3,"click",4,"ngIf"],["mode","indeterminate",3,"diameter","strokeWidth",4,"ngIf"],["src","assets/btn_google.png","alt","login-btn",1,"cursor-pointer",3,"click"],["mode","indeterminate",3,"diameter","strokeWidth"]],template:function(e,t){1&e&&(n.Nb(0,"app-header"),n.Sb(1,"div",0),n.Sb(2,"div",1),n.Sb(3,"span",2),n.uc(4,"Welcome"),n.Rb(),n.Sb(5,"span",3),n.uc(6,"Login to your Claudiu Account"),n.Rb(),n.tc(7,g,1,0,"img",4),n.tc(8,u,1,2,"mat-progress-spinner",5),n.Rb(),n.Rb()),2&e&&(n.Bb(7),n.gc("ngIf",!t.config.isLoader),n.Bb(1),n.gc("ngIf",t.config.isLoader))},directives:[h,r.j,d.a],styles:[".full-screen-page[_ngcontent-%COMP%]{display:flex;height:calc(100vh - 64px);width:100vw;justify-content:center;align-items:center}.login-text[_ngcontent-%COMP%]{font-size:large;font-weight:600}.login-text-welcome[_ngcontent-%COMP%]{font-size:x-large;font-weight:700;margin-bottom:2rem}"]}),e})()}];let b=(()=>{class e{}return e.\u0275mod=n.Kb({type:e}),e.\u0275inj=n.Jb({factory:function(t){return new(t||e)},imports:[[o.e.forChild(m),r.b,d.b]]}),e})()}}]);